<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title>Advent Calendar of Advanced Cyber Fun 2020 - COVID Edition</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="pygmentize-default.css" />

    <style type="text/css">
	body {
        color: white;
		font-size: 20px;
		font-family: monospace;
        background: url(img/bg.jpg);
        background-repeat: repeat; 
        font-family: 'Roboto Mono';
	}
	h1,h2 {
        text-align: center;
        font-size: 30px;
        box-shadow: 0 0 40px 3px #f5624d, 0 0 40px 3px #f5624d;
        background: linear-gradient(90deg, rgba(35,94,111,1), rgba(204,35,30,1),#F5624D, rgba(15,138,95,1));
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
        border-radius: 10px;
        margin-left: 25px;
        margin-right: 25px;
        padding: 15px;
	}
    h2 {
        font-size: 25px;
        margin-top: 50px;
        margin-bottom: 50px;
    }
    .blinking {
        animation: blinking 1s linear infinite;
    }
    @keyframes blinking {
        50% {
            opacity: 0;
        }
    }
    a, a:visited, a:active {
        color: #F5624D;
        text-decoration: none !important;
    }
    a:hover {
        color: #CC231E;
    }
    @keyframes gradient {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }
	.content {
		width: 1000px;
		min-height: 600px;
		border: 3px ridge rgba(128,128,128,0.4);
		margin: 0 auto;
        background: linear-gradient(90deg, #F5624D,rgba(204,35,30,1), rgba(35,94,111,1),  rgba(15,138,95,1));
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
        box-shadow: 0 0 40px 3px black, 0 0 40px 3px black;
        border-radius: 10px;
        opacity: 0.97777;
	}
	.dumbtext {
		padding: 10px 55px;
	}
    .list {
        padding: 0 100px 0 100px;
    }
    .list li {
        padding-bottom: 20px;
    }
    .calendar {
        min-height: 100%;
        padding: 10px 75px 0 75px;
    }
    .calendar tr td {
        padding-bottom: 65px;
    }
    .calendar tr td:first-child {
        text-align: center;
        font-weight: bold;
        background-size: 100% auto;
        background-repeat: no-repeat;
        vertical-align: middle;
    }
    .calendar tr td:first-child div {
        height: 100%;
        vertical-align: middle;
        display: inline-block;
    }
    .calendar tr td:first-child span img {
        width: 90px;
        display: inline-block;
        vertical-align: middle;
    }
    .calendar tr td:first-child span {
        display: inline-block;
        vertical-align: middle;
    }
    .num {
        float: left;
        width: 100px;
        height: 100px;
        border: 1px solid black;
        background-color: #3C8D0D;
    }
    h4 {
        font-weight: normal;
        font-size: 18px;
        padding: 0;
        margin: 25px 0 0 40px;
        text-align: center;
    }
    .description {
        margin: 0 0 0 40px;
    }
    .additional {
        margin: 10px 0 0 40px;
    }
    .hints {
        display: none;
        line-height: 175%;
        border: 1px solid rgba(60,141,13,0.7);
        border-radius: 8px;
        padding: 10px;
        background-color: #378b29;
    }
    .changelog {
        font-size: 14px;
        display: none;
        line-height: 175%;
        border: 1px solid #021d22;
        border-radius: 8px;
        padding: 10px;
        background-color: #968c36;
        box-shadow: 0 0 25px 3px rgb(41, 41, 41), 0 0 25px 3px  rgb(41, 41, 41);
    }
    .voucher {
        background: #0c6e4c;
        padding-top: 20px;
        font-family: "Courier New", Courier, monospace;
        font-size: 15px;
        padding-left: 55px;
    }
    .code {
        background:#0c6e4c;
        margin-left: 40px;
        padding: 20px 20px 0 20px;
        font-family: "Courier New", Courier, monospace;
        font-size: 15px;
    }
    .highlight pre {
        margin: 0;
    }
    .center {
        max-width: 200px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
    }
    </style>
    <script src="snowstorm.js" type="text/javascript"></script>
    <script type="text/javascript">
        function toggle_visibility(id) {
        var e = document.getElementById(id);
        if(e.style.display == 'block')
            e.style.display = 'none';
        else
            e.style.display = 'block';
        }
    </script>
</head>
<body>

<div class="content">
    <h1 class="blinking">Advent Calendar of Advanced Cyber Fun  2020</h1>

    <p class="dumbtext">Ho ho ho! Welcome to the advent calendar of advanced cyber fun, 2020 edition. Everyday we will open one port until the 24th of December, starting from port 1. It is up to you fellas to explore what Santa is up to!</p>

    <p class="dumbtext">Santa likes to play around with exotic protocols and weird technology. Have fun trying to use his services!</p>

    <h2>Let the fun begin!</h2>

    <table class="calendar">
        <tbody>

            <tr id="day01">
                <td><div></div><span><img src="img/1.png" alt="day1"/> 1/TCP</span></td>
                <td>
                    <p class="description">Everybody loves christmas cookies! The best ones are freshly backed, but the old ones may do as well. Even if they SHOULD NOT be used anymore because their <a href="https://tools.ietf.org/html/rfc2965">receipes</a> are deprecated!</p>
                    <p class="additional"></p>

                    <h4><a href="#/" onclick="toggle_visibility('changelog1');">Changelog</a></h4>
                    <div id="changelog1" class="additional changelog">
                        <ul>
                            <li><i>01.12.2020</i>: Added descriptive error message & minor value checking change</li>
                        </ul>
                    </div>
                </td>
            </tr>

            <tr id="day02">
                <td><div></div><span><img src="img/2.png" alt="day2"/> 2/UDP</span></td>
                <td>
                    <p class="description">Routing of Christmas presents requires secure transport, from the north pole to your living room. On a long journey, Santa has to do a lot of handshakes with several third parties to establish new connections. But because of COVID, Santa has to avoid handshakes all the way to stay healthy. Otherwise, Santa won't be able to sniff who made the best Christmas cookies.</p>
                    <p class="additional">Santa and helpers still have to provide secure services, so they started using a secure, yet unknown for most protocol on today's service they said is similar to TLS...?</p>

                    <h4><a href="#/" onclick="toggle_visibility('changelog2');">Changelog</a></h4>
                    <div id="changelog2" class="additional changelog">
                        <ul>
                            <li><i>02.12.2020</i>: UDP packet spamming bug fixed</li>
                        </ul>
                    </div>
                </td>
            </tr>

        </tbody>
    </table>

    <h2 id="challenge">The Challenge</h2>

    <p class="dumbtext">
    This year we have a challenge where you can win an <a href="https://www.amazon.com/" target="_blank">Amazon</a> gift card worth <b>24,12â‚¬</b>! Instructions on how to get the gift card are in the following encrypted message:
    </p>

    <pre class="voucher">
43qfwRmADPGnCA5ECIHo/zhBw2ZGxr9jSVaMaPioNwRHyQAQ83heDxCbpl6nLYoG
IrcdXwzmG3mjxQtIiRINH0A2UfNYuMpRLy38Wf3EcqlU8fFwXL1b6kJ1qkMMZ4QT
Pt0299NuT28+6rz0Ut/FjjVGvL9sv4Gv3LKcDTHMfMyk4xXigxIf25FvcvKopgiq
IU04m4XLW96S72HLTvS1DoiCe2QjByMcOn8+t4lCM4IHyGmsjOPnmQrojC8+wmAH
9+PaMnNA4JKCdj3rY02NRS1BT6lDSD9930IU+Vn2hxz3ZgyAmdKThiHLkUkJI+Oi
    </pre>

    <p class="dumbtext">
    The key is hidden in the 24 ports, one part per port. Each port will contain a 32 byte string, each has to be concatenated and hashed with SHA256 to get the AES key. Here is an example how to generate the key:


            <pre class="voucher">
#!/usr/bin/env python3
import hashlib

with open('tokens') as f:
    tokens = f.read()
    
h = hashlib.sha256()

for token in tokens.split('\n'):
    h.update(token.encode())

print('key: ', h.hexdigest())
            </pre>


    <p class="dumbtext">
    After decoding the key, the message can be decrypted like this:
    </p>

    <pre class="voucher">
openssl enc \
    -aes-256-cbc \
    -d \
    -in message.enc.b64 \
    -a \
    -iv 01020304050607 \
    -K b7f5070cee395922b6dcabb679fc60a556df0de52a7221fac3e7873ea4f36dcc
    </pre>

    <p class="dumbtext">
    Good luck to everyone and have a nice XMAS 2020!
    </p>

    <h2 id="about">Wat?!</h2>

    <p class="dumbtext">All ports are located on <b>xmas.rip</b> ranging from 1 to 24. All other ports and hosts are not part of this Christmas fun (unless the description contains another specific port)! Please refer to the description of each day about what protocols you may need to speak. Talking to Santa might get harder over time! Based on feedback there might be hints for the more complicated challenges.</p>

    <p class="dumbtext">Thanks to technical advances in Christmasland, Santa's miraculous Christmas adventure supports</p>
    <ul class="list">
        <li><b>IPv6</b>: Most (probably even all) ports will support IPv6. Exotic ports without IPv6 support will have a hint in the corresponding description.</li>
        <li><b>TLS</b>: Thanks to <a href="https://letsencrypt.org/" target="_blank">Let's Encrypt</a> Santa can securely distribute the miracles of Christmas. However, Santa intentionally disabled HSTS, so you can try and fail to connect to the ports with your browser.</li>
    </ul>

    <h2 id="contact">Further information</h2>

    <ul class="list">
        <li>
            Send your Christmas greetings to <b>advent [AT] adversec [DOT] com</b>.
        </li>
        <li>This page has been created by: 
            <ul>
                <li><a href="https://twitter.com/_takeshix" target="_blank">@_takeshix</a></li>
                <li><a href="https://twitter.com/lod108" target="_blank">@lod108</a></li>
                <li><a href="https://twitter.com/br3zel" target="_blank">@br3zel</a></li>
                <li><a href="https://twitter.com/sven_to" target="_blank">@sven_to</a></li>
            </ul>
        </li>
    </ul>

</div>

<!-- Thanks to all the authors of the amazing XMAS ASCII arts! https://asciiart.website/index.php?art=holiday/christmas/other http://ascii.co.uk/art/xmas -->
<!-- Kudos to Steve Lianardo for the awesome Christmas icons! http://www.iconarchive.com/show/free-christmas-flat-icons-by-stevelianardo.html -->

</body>
</html>
